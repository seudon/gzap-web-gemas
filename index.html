<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Primary Meta Tags -->
    <title>スターマス - Star Math | 小学生向け足し算ゲーム</title>
    <meta name="title" content="スターマス - Star Math | 小学生向け足し算ゲーム">
    <meta name="description" content="小学一年生向けの楽しい足し算学習ゲーム。宇宙をテーマにした派手なエフェクトとアニメーションで、楽しく算数を学べます。必殺技システムや時間制限モードで、飽きずに学習できます。">
    <meta name="keywords" content="算数,足し算,学習ゲーム,小学生,教育,子供向け,Star Math,スターマス">
    <meta name="author" content="Star Math">
    <meta name="theme-color" content="#1a1a2e">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://seudon.github.io/gzap-web-gemas/">
    <meta property="og:title" content="スターマス - Star Math | 小学生向け足し算ゲーム">
    <meta property="og:description" content="小学一年生向けの楽しい足し算学習ゲーム。宇宙をテーマにした派手なエフェクトで楽しく算数を学べます。">
    <meta property="og:image" content="https://seudon.github.io/gzap-web-gemas/images/og-image.png">
    <meta property="og:locale" content="ja_JP">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://seudon.github.io/gzap-web-gemas/">
    <meta property="twitter:title" content="スターマス - Star Math | 小学生向け足し算ゲーム">
    <meta property="twitter:description" content="小学一年生向けの楽しい足し算学習ゲーム。宇宙をテーマにした派手なエフェクトで楽しく算数を学べます。">
    <meta property="twitter:image" content="https://seudon.github.io/gzap-web-gemas/images/og-image.png">

    <!-- Mobile Web App -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="スターマス">
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Performance Optimization -->
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>

    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- ゲームコンテナ -->
    <div class="game-container">

        <!-- ヘッダー：レベル、スコア、経験値バー -->
        <header class="game-header">
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-icon">⭐</span>
                    <span class="stat-label stat-label-full">Level:</span>
                    <span class="stat-label stat-label-short">Lv.</span>
                    <span id="level" class="stat-value">1</span>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">✨</span>
                    <span class="stat-label stat-label-full">Score:</span>
                    <span id="score" class="stat-value">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">🔥</span>
                    <span class="stat-label stat-label-full">Combo:</span>
                    <span class="stat-label stat-label-short">x</span>
                    <span id="combo" class="stat-value">0</span>
                </div>
            </div>

            <!-- 経験値バー -->
            <div class="exp-bar-container">
                <div id="expBar" class="exp-bar">
                    <div class="exp-bar-fill"></div>
                </div>
                <span class="exp-text">
                    <span id="currentExp">0</span> / <span id="maxExp">10</span> EXP
                </span>
            </div>

            <!-- タイマーバー（時間制限モード有効時のみ表示） -->
            <div id="timerContainer" class="timer-container" style="display: none;">
                <div class="timer-bar-wrapper">
                    <div id="timerBar" class="timer-bar"></div>
                </div>
                <span id="timerText" class="timer-text">10.0s</span>
            </div>
        </header>

        <!-- メインゲームエリア -->
        <main class="game-main">

            <!-- 問題表示エリア -->
            <div class="question-area">
                <div class="question-display">
                    <span id="num1" class="number">3</span>
                    <span id="operator" class="operator">+</span>
                    <span id="num2" class="number">5</span>
                    <span id="equals" class="operator">=</span>
                    <span class="question-mark">?</span>
                </div>
            </div>

            <!-- 回答ボタンエリア -->
            <div class="answer-area">
                <div id="answerButtons" class="answer-buttons">
                    <!-- JavaScriptで動的に生成 -->
                </div>
            </div>

            <!-- パーティクルコンテナ -->
            <div id="particleContainer" class="particle-container"></div>

            <!-- レベルアップ演出用 -->
            <div id="levelUpEffect" class="level-up-effect hidden">
                <div class="level-up-content">
                    <h2 class="level-up-title">LEVEL UP!</h2>
                    <p class="level-up-message">新しい星が輝き始めた！</p>
                </div>
            </div>

            <!-- ゲームクリア演出用 -->
            <div id="gameCompleteEffect" class="game-complete-effect hidden">
                <div class="complete-content">
                    <h1 class="complete-title">🎉 CONGRATULATIONS! 🎉</h1>
                    <p class="complete-message">すべての星座をマスターしました！</p>
                    <p class="complete-score">最終スコア: <span id="finalScore">0</span></p>

                    <!-- エンディングドラムボタン -->
                    <p class="drum-message">エンディングに合わせてドラムを叩いてみよう！</p>
                    <div class="drum-buttons">
                        <button class="drum-btn" data-drum="1">1</button>
                        <button class="drum-btn" data-drum="2">2</button>
                        <button class="drum-btn" data-drum="3">3</button>
                        <button class="drum-btn" data-drum="4">4</button>
                    </div>

                    <button id="restartButton" class="restart-button">もう一度挑戦</button>
                </div>
            </div>

        </main>

        <!-- フッター（オプション） -->
        <footer class="game-footer">
            <!-- 必殺技システム -->
            <div class="special-moves-container">
                <!-- 必殺技ゲージ -->
                <div class="special-gauge-container">
                    <span class="special-gauge-label">⚡ 必殺技ゲージ</span>
                    <div class="special-gauge-wrapper">
                        <div id="specialGauge" class="special-gauge">
                            <div class="special-gauge-fill"></div>
                        </div>
                        <span id="specialGaugeText" class="special-gauge-text">0%</span>
                    </div>
                </div>

                <!-- 必殺技ボタン -->
                <div class="special-buttons">
                    <button id="timeStopBtn" class="special-btn" data-move="timeStop" disabled>
                        <span class="special-icon">⏸️</span>
                        <span class="special-name">時間停止</span>
                        <span class="special-cost">消費: 20</span>
                    </button>
                    <button id="slowMotionBtn" class="special-btn" data-move="slowMotion" disabled>
                        <span class="special-icon">🐌</span>
                        <span class="special-name">スロー</span>
                        <span class="special-cost">消費: 15</span>
                    </button>
                    <button id="hintBtn" class="special-btn" data-move="hint" disabled>
                        <span class="special-icon">💡</span>
                        <span class="special-name">ヒント</span>
                        <span class="special-cost">消費: 5</span>
                    </button>
                </div>
            </div>

            <p class="game-tip" id="gameTip">正解すると星が増えるよ！</p>
        </footer>

    </div>

    <!-- デバッグパネル開閉ボタン -->
    <button id="openDebug" class="debug-icon-btn" style="display: none;" title="デバッグモード">🛠️</button>

    <!-- デバッグパネル -->
    <div id="debugPanel" class="debug-panel">
        <div class="debug-header">
            <h3>🛠️ デバッグモード</h3>
            <button id="closeDebug" class="debug-close">×</button>
        </div>
        <div class="debug-content">
            <div class="debug-section">
                <h4>レベル選択（即座に反映）</h4>
                <div class="level-buttons">
                    <button class="level-btn" data-level="1">Lv1</button>
                    <button class="level-btn" data-level="2">Lv2</button>
                    <button class="level-btn" data-level="3">Lv3</button>
                    <button class="level-btn" data-level="4">Lv4</button>
                    <button class="level-btn" data-level="5">Lv5</button>
                    <button class="level-btn" data-level="6">Lv6</button>
                    <button class="level-btn" data-level="7">Lv7</button>
                    <button class="level-btn" data-level="8">Lv8</button>
                    <button class="level-btn" data-level="9">Lv9</button>
                    <button class="level-btn" data-level="10">Lv10</button>
                </div>
                <div class="level-buttons">
                    <button class="level-btn" data-level="11">Lv11</button>
                    <button class="level-btn" data-level="12">Lv12</button>
                    <button class="level-btn" data-level="13">Lv13</button>
                    <button class="level-btn" data-level="14">Lv14</button>
                    <button class="level-btn" data-level="15">Lv15</button>
                    <button class="level-btn" data-level="16">Lv16</button>
                    <button class="level-btn" data-level="17">Lv17</button>
                    <button class="level-btn" data-level="18">Lv18</button>
                    <button class="level-btn" data-level="19">Lv19</button>
                    <button class="level-btn" data-level="20">Lv20</button>
                </div>
            </div>
            <div class="debug-section">
                <h4>ステータス</h4>
                <p>現在のレベル: <span id="debugLevel">1</span></p>
                <p>コンボ: <span id="debugCombo">0</span></p>
                <p>経験値: <span id="debugExp">0</span> / <span id="debugMaxExp">10</span></p>
            </div>
        </div>
    </div>

    <!-- 設定パネル開閉ボタン -->
    <button id="openSettings" class="settings-icon-btn" style="display: none;" title="設定">⚙️</button>

    <!-- 設定パネル -->
    <div id="settingsPanel" class="settings-panel">
        <div class="settings-header">
            <h3>⚙️ 設定</h3>
            <button id="closeSettings" class="settings-close">×</button>
        </div>
        <div class="settings-content">
            <div class="settings-section">
                <h4>サウンド</h4>
                <div class="setting-item">
                    <label for="soundEnabled">サウンド:</label>
                    <button id="soundEnabled" class="sound-toggle-btn">OFF</button>
                </div>
            </div>
            <div class="settings-section">
                <h4>音量調整</h4>
                <div class="setting-item">
                    <label for="bgmVolume">BGM音量:</label>
                    <input type="range" id="bgmVolume" min="0" max="100" value="30" class="volume-slider">
                    <span id="bgmVolumeValue" class="volume-value">30%</span>
                </div>
                <div class="setting-item">
                    <label for="effectVolume">効果音音量:</label>
                    <input type="range" id="effectVolume" min="0" max="100" value="50" class="volume-slider">
                    <span id="effectVolumeValue" class="volume-value">50%</span>
                </div>
            </div>
            <div class="settings-section">
                <h4>ゲーム設定</h4>
                <div class="setting-item">
                    <label for="timeLimitEnabled">時間制限:</label>
                    <button id="timeLimitEnabled" class="sound-toggle-btn">OFF</button>
                </div>
            </div>
            <div class="settings-section">
                <h4>計算の種類</h4>
                <div class="operator-selection">
                    <div class="setting-item operator-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="additionEnabled" checked>
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-text">足し算 (+)</span>
                        </label>
                    </div>
                    <div class="setting-item operator-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="subtractionEnabled">
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-text">引き算 (-)</span>
                        </label>
                    </div>
                    <div class="setting-item operator-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="multiplicationEnabled">
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-text">掛け算 (x)</span>
                        </label>
                    </div>
                </div>
                <p class="operator-hint">※ 最低1つは選択してください</p>
            </div>
        </div>
    </div>

    <!-- GSAP CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <!-- ゲームスクリプト（main.js を先に読み込む - DEBUG_MODE定数を定義）-->
    <script src="js/knowledge.js"></script>
    <script src="js/main.js"></script>
    <script src="js/sound.js"></script>
    <script src="js/animations.js"></script>
</body>
</html>
